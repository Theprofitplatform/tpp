---
/**
 * TestimonialsGrid Component
 * Displays client testimonials in a responsive card grid
 * Features quotes, author info, company, ratings, and hover effects
 *
 * Props:
 * - testimonials: Array of testimonial objects
 * - title: Section title (default: "What Our Clients Say")
 * - subtitle: Optional subtitle text
 *
 * Data structure for testimonials injection:
 * testimonials = [
 *   {
 *     quote: "The testimonial text...",
 *     author: "John Smith",
 *     company: "ABC Corp",
 *     role: "CEO",
 *     rating: 5,
 *     photo: "/images/testimonials/john.jpg" (optional)
 *   },
 *   ...
 * ]
 */

interface Testimonial {
  quote: string;
  author: string;
  company: string;
  role?: string;
  rating: number;
  photo?: string;
}

interface Props {
  testimonials?: Testimonial[];
  title?: string;
  subtitle?: string;
}

const {
  testimonials = [
    // PLACEHOLDER DATA - Replace with actual client testimonials
    {
      quote: "The Profit Platform transformed our digital presence. We've seen a 150% increase in qualified leads within just 3 months. Their team is responsive, knowledgeable, and truly invested in our success.",
      author: "Sarah Mitchell",
      company: "Sydney Property Group",
      role: "Marketing Director",
      rating: 5
    },
    {
      quote: "Working with The Profit Platform has been game-changing. Their SEO strategies helped us rank #1 for our key terms in Sydney. The ROI speaks for itself - 3x growth in organic traffic!",
      author: "David Chen",
      company: "Parramatta Legal Services",
      role: "Managing Partner",
      rating: 5
    },
    {
      quote: "Finally, a marketing agency that delivers on promises! Clear communication, transparent reporting, and real results. Our conversion rate doubled in the first quarter.",
      author: "Emma Rodriguez",
      company: "Bondi Fitness Studio",
      role: "Owner & Founder",
      rating: 5
    }
  ],
  title = "What Our Clients Say",
  subtitle = "Real results from real Sydney businesses"
} = Astro.props;

// Helper function to render star rating
const renderStars = (rating: number) => {
  return Array.from({ length: 5 }, (_, i) => i < rating);
};
---

<section class="py-20 md:py-32" aria-labelledby="testimonials-heading">
  <div class="container mx-auto px-4">
    <div class="max-w-7xl mx-auto">
      <!-- Section Header -->
      <div class="text-center mb-16">
        <h2
          id="testimonials-heading"
          class="text-4xl md:text-5xl font-black mb-6 bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent"
        >
          {title}
        </h2>
        {subtitle && (
          <p class="text-xl text-gray-700 max-w-3xl mx-auto">
            {subtitle}
          </p>
        )}
      </div>

      <!-- Testimonials Grid -->
      <div
        class="grid md:grid-cols-2 lg:grid-cols-3 gap-8"
        role="list"
      >
        {testimonials.map((testimonial, index) => (
          <article
            class="group bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 p-8 relative overflow-hidden animate-fade-in"
            style={`animation-delay: ${index * 150}ms`}
            role="listitem"
          >
            <!-- Decorative Quote Icon -->
            <div class="absolute top-6 right-6 text-6xl text-indigo-100 opacity-50 select-none" aria-hidden="true">
              "
            </div>

            <!-- Star Rating -->
            <div class="flex gap-1 mb-4 relative z-10" role="img" aria-label={`${testimonial.rating} out of 5 stars`}>
              {renderStars(testimonial.rating).map((filled) => (
                <svg
                  class={`w-5 h-5 ${filled ? 'text-yellow-400' : 'text-gray-300'}`}
                  fill="currentColor"
                  viewBox="0 0 20 20"
                  aria-hidden="true"
                >
                  <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                </svg>
              ))}
            </div>

            <!-- Quote -->
            <blockquote class="text-gray-700 leading-relaxed mb-6 relative z-10">
              <p class="text-lg">"{testimonial.quote}"</p>
            </blockquote>

            <!-- Author Info -->
            <div class="flex items-center gap-4 relative z-10 border-t border-gray-100 pt-6">
              <div class="w-14 h-14 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-2xl font-bold text-white shadow-lg">
                {testimonial.author.charAt(0)}
              </div>

              <div>
                <div class="font-bold text-gray-900">{testimonial.author}</div>
                {testimonial.role && (
                  <div class="text-sm text-gray-600">{testimonial.role}</div>
                )}
                <div class="text-sm font-semibold text-indigo-600">{testimonial.company}</div>
              </div>
            </div>

            <!-- Gradient Overlay on Hover -->
            <div class="absolute inset-0 bg-gradient-to-br from-indigo-50/50 via-purple-50/50 to-pink-50/50 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none" aria-hidden="true"></div>
          </article>
        ))}
      </div>

      <!-- Trust Badge Footer -->
      <div class="mt-12 text-center">
        <div class="inline-flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-2xl shadow-xl">
          <span class="text-2xl" aria-hidden="true">‚≠ê</span>
          <span class="font-bold text-lg">127+ Five-Star Reviews</span>
          <span class="text-sm opacity-90">| Average rating: 5.0/5.0</span>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fade-in 0.6s ease-out forwards;
    opacity: 0;
  }

  /* Performance optimization */
  article {
    will-change: transform, box-shadow;
  }

  /* Enhanced focus states for accessibility */
  article:focus-within {
    outline: 3px solid #6366f1;
    outline-offset: 4px;
  }

  /* Ensure blockquote styling */
  blockquote {
    quotes: none;
  }

  /* Responsive text sizing */
  @media (max-width: 768px) {
    blockquote p {
      font-size: 1rem;
    }
  }
</style>