---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import RelatedContent from '../../components/RelatedContent.astro';

const apiUrl = '';
---

<BaseLayout
  title="SEO Opportunity Calculator | Discover Your Revenue Potential"
  description="Calculate potential revenue from improved Google rankings. See how much traffic and sales you're missing out on. Free SEO ROI calculator for Sydney businesses."
>
  <Header />
  
  <!-- Tool Analytics Tracker -->
  <script is:inline src="/js/tool-analytics.js"></script>

  <main id="main-content" role="main">
    <!-- Breadcrumbs -->
    <nav class="breadcrumbs" aria-label="Breadcrumb">
      <div class="container">
        <ol itemscope itemtype="https://schema.org/BreadcrumbList">
          <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/">
              <span itemprop="name">Home</span>
            </a>
            <meta itemprop="position" content="1" />
          </li>
          <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/tools">
              <span itemprop="name">Free Tools</span>
            </a>
            <meta itemprop="position" content="2" />
          </li>
          <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <span itemprop="name">SEO Opportunity Calculator</span>
            <meta itemprop="position" content="3" />
          </li>
        </ol>
      </div>
    </nav>

    <!-- Hero Section -->
    <section class="opportunity-hero">
      <div class="hero-background-effects">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
        <div class="grid-overlay"></div>
      </div>

      <div class="container">
        <div class="opportunity-hero-content">
          <!-- Badge -->
          <div class="hero-badge">
            <span class="badge-icon">💰</span>
            <span class="badge-text">Free Analysis • Real Revenue Data</span>
          </div>

          <!-- Main Heading -->
          <h1 class="hero-title">
            <span class="title-line-1">Discover Your</span>
            <span class="title-line-2">Hidden SEO</span>
            <span class="title-accent">Revenue Opportunity</span>
          </h1>

          <!-- Subtitle -->
          <p class="hero-description">
            Most Sydney businesses leave $50,000-200,000/year on the table by missing high-value SEO opportunities.
            Find out exactly how much revenue you're missing and which opportunities to prioritize.
          </p>

          <!-- Value Props -->
          <div class="value-props">
            <div class="value-prop">
              <div class="prop-icon">✓</div>
              <span>Real competitor data</span>
            </div>
            <div class="value-prop">
              <div class="prop-icon">✓</div>
              <span>Industry benchmarks</span>
            </div>
            <div class="value-prop">
              <div class="prop-icon">✓</div>
              <span>90-day action plan</span>
            </div>
            <div class="value-prop">
              <div class="prop-icon">✓</div>
              <span>ROI projections</span>
            </div>
          </div>

          <!-- Scroll Indicator -->
          <div class="scroll-indicator">
            <span class="scroll-text">Calculate your opportunity ↓</span>
            <div class="scroll-arrow">
              <i class="fas fa-chevron-down"></i>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Calculator Tool -->
    <section class="calculator-section">
      <div class="container">
        <div class="calculator-card">
          <!-- Step Indicator -->
          <div class="step-indicator" id="stepIndicator">
            <div class="step active" data-step="1">
              <div class="step-number">1</div>
              <div class="step-label">Your Business</div>
            </div>
            <div class="step-connector"></div>
            <div class="step" data-step="2">
              <div class="step-number">2</div>
              <div class="step-label">Analysis</div>
            </div>
            <div class="step-connector"></div>
            <div class="step" data-step="3">
              <div class="step-number">3</div>
              <div class="step-label">Opportunities</div>
            </div>
          </div>

          <!-- Form -->
          <form id="opportunityForm" class="opportunity-form">
            <div class="form-section">
              <h2>Tell us about your business</h2>
              <p class="form-intro">We need a few details to calculate accurate revenue opportunities for your specific situation.</p>

              <div class="form-grid">
                <div class="form-group full-width">
                  <label for="website">
                    <i class="fas fa-globe"></i>
                    Your Website
                  </label>
                  <input
                    type="url"
                    id="website"
                    name="website"
                    placeholder="https://yourwebsite.com.au"
                    required
                  />
                  <small>Enter your full website URL</small>
                </div>

                <div class="form-group">
                  <label for="industry">
                    <i class="fas fa-briefcase"></i>
                    Industry
                  </label>
                  <select id="industry" name="industry" required>
                    <option value="">Select your industry</option>
                    <option value="legal">Legal Services</option>
                    <option value="accounting">Accounting & Finance</option>
                    <option value="real-estate">Real Estate</option>
                    <option value="healthcare">Healthcare & Medical</option>
                    <option value="home-services">Home Services (Plumbing, Electrical, etc.)</option>
                    <option value="dental">Dental</option>
                    <option value="automotive">Automotive</option>
                    <option value="ecommerce">E-commerce</option>
                    <option value="hospitality">Hospitality & Tourism</option>
                    <option value="fitness">Fitness & Wellness</option>
                    <option value="education">Education & Training</option>
                    <option value="b2b-services">B2B Services</option>
                    <option value="other">Other</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="serviceArea">
                    <i class="fas fa-map-marker-alt"></i>
                    Primary Service Area
                  </label>
                  <select id="serviceArea" name="serviceArea" required>
                    <option value="">Select service area</option>
                    <option value="sydney-cbd">Sydney CBD</option>
                    <option value="sydney-metro">Greater Sydney</option>
                    <option value="nsw">All of NSW</option>
                    <option value="australia">All of Australia</option>
                    <option value="global">Global/Online</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="avgDealValue">
                    <i class="fas fa-dollar-sign"></i>
                    Average Customer Value
                  </label>
                  <select id="avgDealValue" name="avgDealValue" required>
                    <option value="">Select range</option>
                    <option value="500">Under $500</option>
                    <option value="1500">$500 - $2,500</option>
                    <option value="5000">$2,500 - $10,000</option>
                    <option value="15000">$10,000 - $25,000</option>
                    <option value="50000">$25,000 - $100,000</option>
                    <option value="150000">Over $100,000</option>
                  </select>
                  <small>Lifetime value or average project/sale</small>
                </div>

                <div class="form-group">
                  <label for="primaryGoal">
                    <i class="fas fa-bullseye"></i>
                    Primary Goal
                  </label>
                  <select id="primaryGoal" name="primaryGoal" required>
                    <option value="">What matters most?</option>
                    <option value="leads">More leads/inquiries</option>
                    <option value="sales">More sales/revenue</option>
                    <option value="visibility">Better visibility/rankings</option>
                    <option value="traffic">More website traffic</option>
                  </select>
                </div>
              </div>

              <button type="submit" class="btn-primary btn-large" id="calculateButton">
                <span class="btn-text">
                  <i class="fas fa-calculator"></i>
                  Calculate My Opportunity
                </span>
                <span class="btn-loader" style="display: none;">
                  <i class="fas fa-spinner fa-spin"></i>
                  Analyzing...
                </span>
              </button>

              <p class="privacy-note">
                <i class="fas fa-lock"></i>
                Your data is private and secure. We'll never share your information.
              </p>
            </div>
          </form>

          <!-- Loading State -->
          <div id="loadingState" class="loading-state" style="display: none;">
            <div class="loading-animation">
              <div class="pulse-ring"></div>
              <div class="loading-icon">
                <i class="fas fa-chart-line fa-3x"></i>
              </div>
            </div>
            <h3 id="loadingTitle">Analyzing Your Opportunity...</h3>
            <p id="loadingSubtext">This will take 15-30 seconds</p>

            <div class="analysis-steps">
              <div class="analysis-step active" data-step="1">
                <i class="fas fa-circle-notch fa-spin"></i>
                <span>Scanning your website</span>
              </div>
              <div class="analysis-step" data-step="2">
                <i class="fas fa-circle-notch"></i>
                <span>Finding competitor keywords</span>
              </div>
              <div class="analysis-step" data-step="3">
                <i class="fas fa-circle-notch"></i>
                <span>Calculating search volumes</span>
              </div>
              <div class="analysis-step" data-step="4">
                <i class="fas fa-circle-notch"></i>
                <span>Generating opportunity report</span>
              </div>
            </div>
          </div>

          <!-- Results Section -->
          <div id="resultsSection" class="results-section" style="display: none;">
            <!-- Results will be dynamically inserted here -->
          </div>

          <!-- Error State -->
          <div id="errorState" class="error-state" style="display: none;">
            <i class="fas fa-exclamation-circle fa-3x"></i>
            <h3>Analysis Unavailable</h3>
            <p id="errorMessage"></p>
            <div class="error-actions">
              <button class="btn-secondary" id="tryAgainButton">
                <i class="fas fa-redo"></i> Try Again
              </button>
              <a href="/contact" class="btn-primary">
                <i class="fas fa-comment"></i> Get Manual Analysis
              </a>
            </div>
            <p class="error-help">Need help? Call <a href="tel:+61487286451">0487 286 451</a></p>
          </div>
        </div>
      </div>
    </section>

    <!-- How It Works -->
    <section class="how-it-works">
      <div class="container">
        <h2>How We Calculate Your Opportunity</h2>
        <div class="process-grid">
          <div class="process-step">
            <div class="process-icon">1</div>
            <h3>Competitor Analysis</h3>
            <p>We identify your top 3-5 competitors and analyze the keywords they rank for that you don't.</p>
          </div>
          <div class="process-step">
            <div class="process-icon">2</div>
            <h3>Search Volume Data</h3>
            <p>We pull real search volume data for Sydney and calculate how many customers are searching.</p>
          </div>
          <div class="process-step">
            <div class="process-icon">3</div>
            <h3>Revenue Modeling</h3>
            <p>Using your industry's average conversion rates and your deal value, we project realistic revenue.</p>
          </div>
          <div class="process-step">
            <div class="process-icon">4</div>
            <h3>Priority Roadmap</h3>
            <p>We rank opportunities by difficulty vs. impact, showing you exactly where to start.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Social Proof -->
    <section class="social-proof">
      <div class="container">
        <h2>Real Results from Sydney Businesses</h2>
        <div class="testimonial-grid">
          <div class="testimonial">
            <div class="quote-icon">"</div>
            <p>"The opportunity calculator showed us $87k/year we were missing. Within 3 months of fixing those gaps, we're tracking $4,200/month in new revenue."</p>
            <div class="testimonial-author">
              <strong>Sarah M.</strong>
              <span>Legal Practice, Sydney</span>
            </div>
          </div>
          <div class="testimonial">
            <div class="quote-icon">"</div>
            <p>"Finally, an SEO tool that speaks business language. Seeing the actual dollar amounts convinced our board to approve the SEO budget."</p>
            <div class="testimonial-author">
              <strong>James K.</strong>
              <span>Accounting Firm, Parramatta</span>
            </div>
          </div>
          <div class="testimonial">
            <div class="quote-icon">"</div>
            <p>"We were skeptical, but the analysis was spot-on. The 'quick wins' section alone generated 23 new leads in the first month."</p>
            <div class="testimonial-author">
              <strong>Michael T.</strong>
              <span>Home Services, Western Sydney</span>
            </div>
          </div>
        </div>
      </div>
    </section>
    <RelatedContent
      category="SEO"
      tags={['SEO', 'ROI', 'Google Ads']}
      showBlogPosts={true}
      showServices={true}
    />
  </main>
</BaseLayout>

<style is:global>
  /* ==========================================
     SEO OPPORTUNITY CALCULATOR STYLES
     ========================================== */

  /* Container */
  .container {
    max-width: 1280px;
    margin: 0 auto;
    padding: 0 20px;
  }

  /* Breadcrumbs */
  .breadcrumbs {
    padding: 1rem 0;
    background: #f8fafc;
    font-size: 0.875rem;
  }

  .breadcrumbs ol {
    display: flex;
    gap: 0.5rem;
    list-style: none;
    padding: 0;
    margin: 0;
    flex-wrap: wrap;
  }

  .breadcrumbs li:not(:last-child)::after {
    content: '›';
    margin-left: 0.5rem;
    color: #94a3b8;
  }

  .breadcrumbs a {
    color: #667eea;
    text-decoration: none;
  }

  .breadcrumbs a:hover {
    text-decoration: underline;
  }

  /* Hero Section */
  .opportunity-hero {
    position: relative;
    padding: 180px 0 100px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    text-align: center;
    overflow: hidden;
  }

  @media (max-width: 768px) {
    .opportunity-hero {
      padding: 120px 0 80px;
    }
  }

  .hero-background-effects {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
  }

  .gradient-orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(60px);
    opacity: 0.3;
    animation: float 20s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translate(0, 0) scale(1); }
    33% { transform: translate(30px, -30px) scale(1.1); }
    66% { transform: translate(-20px, 20px) scale(0.9); }
  }

  .gradient-orb:nth-child(1) {
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, #fff 0%, transparent 70%);
    top: -100px;
    left: -100px;
  }

  .gradient-orb:nth-child(2) {
    width: 300px;
    height: 300px;
    background: radial-gradient(circle, #fbbf24 0%, transparent 70%);
    bottom: -50px;
    right: -50px;
    animation-delay: 7s;
  }

  .gradient-orb:nth-child(3) {
    width: 250px;
    height: 250px;
    background: radial-gradient(circle, #10b981 0%, transparent 70%);
    top: 50%;
    right: 10%;
    animation-delay: 14s;
  }

  .grid-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image:
      linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
    background-size: 50px 50px;
    opacity: 0.5;
  }

  .opportunity-hero-content {
    position: relative;
    z-index: 1;
    max-width: 900px;
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    padding: 0.75rem 1.5rem;
    border-radius: 50px;
    font-weight: 600;
    color: white;
    margin-bottom: 2rem;
    border: 1px solid rgba(255, 255, 255, 0.3);
  }

  .badge-icon {
    font-size: 1.25rem;
  }

  .hero-title {
    font-size: 3.5rem;
    font-weight: 900;
    line-height: 1.1;
    margin-bottom: 1.5rem;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  }

  @media (max-width: 768px) {
    .hero-title {
      font-size: 2.5rem;
    }
  }

  .title-line-1,
  .title-line-2 {
    display: block;
  }

  .title-accent {
    background: linear-gradient(to right, #fbbf24, #f59e0b);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    display: block;
  }

  .hero-description {
    font-size: 1.25rem;
    line-height: 1.6;
    color: rgba(255, 255, 255, 0.95);
    margin-bottom: 3rem;
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
  }

  @media (max-width: 768px) {
    .hero-description {
      font-size: 1.125rem;
    }
  }

  .value-props {
    display: flex;
    gap: 1.5rem;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 3rem;
  }

  .value-prop {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
  }

  .prop-icon {
    width: 24px;
    height: 24px;
    background: rgba(16, 185, 129, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #10b981;
    font-size: 0.875rem;
  }

  .scroll-indicator {
    margin-top: 3rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
  }

  .scroll-text {
    font-size: 1rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
  }

  .scroll-arrow {
    animation: bounce 2s ease-in-out infinite;
  }

  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(10px); }
  }

  .scroll-arrow i {
    font-size: 2rem;
    color: white;
    opacity: 0.8;
  }

  /* Calculator Section */
  .calculator-section {
    padding: 80px 0;
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
  }

  .calculator-card {
    background: white;
    border-radius: 24px;
    padding: 3rem;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    max-width: 900px;
    margin: 0 auto;
  }

  @media (max-width: 768px) {
    .calculator-card {
      padding: 2rem 1.5rem;
    }
  }

  /* Step Indicator */
  .step-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 3rem;
    gap: 0;
  }

  .step {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    opacity: 0.4;
    transition: all 0.3s ease;
  }

  .step.active {
    opacity: 1;
  }

  .step.completed {
    opacity: 1;
  }

  .step-number {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: #e2e8f0;
    color: #64748b;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: 1.25rem;
    transition: all 0.3s ease;
  }

  .step.active .step-number {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
  }

  .step.completed .step-number {
    background: #10b981;
    color: white;
  }

  .step-label {
    font-size: 0.875rem;
    font-weight: 600;
    color: #64748b;
  }

  .step.active .step-label {
    color: #667eea;
  }

  .step-connector {
    width: 80px;
    height: 2px;
    background: #e2e8f0;
    margin: 0 -10px;
    margin-bottom: 1.75rem;
  }

  @media (max-width: 768px) {
    .step-connector {
      width: 40px;
    }

    .step-label {
      font-size: 0.75rem;
    }

    .step-number {
      width: 40px;
      height: 40px;
      font-size: 1rem;
    }
  }

  /* Form */
  .form-section h2 {
    font-size: 2rem;
    font-weight: 900;
    margin-bottom: 0.5rem;
    color: #1e293b;
    text-align: center;
  }

  .form-intro {
    text-align: center;
    color: #64748b;
    margin-bottom: 2rem;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .form-group.full-width {
    grid-column: 1 / -1;
  }

  .form-group label {
    display: block;
    font-weight: 600;
    margin-bottom: 0.75rem;
    color: #1e293b;
    font-size: 1rem;
  }

  .form-group label i {
    color: #667eea;
    margin-right: 0.5rem;
  }

  .form-group input,
  .form-group select {
    width: 100%;
    padding: 1rem 1.25rem;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    font-size: 1rem;
    transition: all 0.3s ease;
    background: white;
  }

  .form-group input:focus,
  .form-group select:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }

  .form-group small {
    display: block;
    margin-top: 0.5rem;
    color: #64748b;
    font-size: 0.875rem;
  }

  /* Buttons */
  .btn-primary {
    width: 100%;
    padding: 1.25rem 2rem;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 1.125rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
  }

  .btn-primary:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
  }

  .btn-primary:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .btn-secondary {
    padding: 1rem 1.75rem;
    background: white;
    color: #667eea;
    border: 2px solid #667eea;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .btn-secondary:hover {
    background: #667eea;
    color: white;
  }

  .privacy-note {
    text-align: center;
    color: #64748b;
    font-size: 0.875rem;
    margin-top: 1rem;
  }

  .privacy-note i {
    color: #10b981;
    margin-right: 0.5rem;
  }

  /* Loading State */
  .loading-state {
    text-align: center;
    padding: 4rem 2rem;
  }

  .loading-animation {
    position: relative;
    display: inline-block;
    margin-bottom: 2rem;
  }

  .pulse-ring {
    position: absolute;
    width: 120px;
    height: 120px;
    border: 4px solid #667eea;
    border-radius: 50%;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: pulse-ring 2s ease-out infinite;
  }

  @keyframes pulse-ring {
    0% {
      transform: translate(-50%, -50%) scale(0.8);
      opacity: 1;
    }
    100% {
      transform: translate(-50%, -50%) scale(1.3);
      opacity: 0;
    }
  }

  .loading-icon {
    position: relative;
    z-index: 1;
  }

  .loading-icon i {
    color: #667eea;
    animation: pulse-icon 2s ease-in-out infinite;
  }

  @keyframes pulse-icon {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
  }

  #loadingTitle {
    font-size: 1.75rem;
    font-weight: 800;
    color: #1e293b;
    margin-bottom: 0.5rem;
  }

  #loadingSubtext {
    color: #64748b;
    margin-bottom: 3rem;
  }

  .analysis-steps {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    max-width: 400px;
    margin: 0 auto;
    text-align: left;
  }

  .analysis-step {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    border-radius: 8px;
    background: #f8fafc;
    color: #94a3b8;
    transition: all 0.3s ease;
  }

  .analysis-step.active {
    background: rgba(102, 126, 234, 0.1);
    color: #667eea;
  }

  .analysis-step.completed {
    color: #10b981;
  }

  .analysis-step.active i {
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  /* Error State */
  .error-state {
    text-align: center;
    padding: 3rem 0;
  }

  .error-state i {
    color: #ef4444;
    margin-bottom: 1.5rem;
  }

  .error-state h3 {
    font-size: 1.8rem;
    color: #1e293b;
    margin-bottom: 1rem;
  }

  .error-state p {
    color: #64748b;
    margin-bottom: 2rem;
  }

  .error-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 1rem;
  }

  .error-help {
    font-size: 0.9rem;
    color: #64748b;
  }

  .error-help a {
    color: #667eea;
    font-weight: 700;
    text-decoration: none;
  }

  .error-help a:hover {
    text-decoration: underline;
  }

  /* How It Works */
  .how-it-works {
    padding: 80px 0;
    background: white;
  }

  .how-it-works h2 {
    text-align: center;
    font-size: 2.5rem;
    font-weight: 900;
    margin-bottom: 3rem;
    color: #1e293b;
  }

  .process-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
  }

  .process-step {
    text-align: center;
    padding: 2rem;
  }

  .process-icon {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: 900;
    margin: 0 auto 1.5rem;
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
  }

  .process-step h3 {
    font-size: 1.25rem;
    font-weight: 800;
    margin-bottom: 0.75rem;
    color: #1e293b;
  }

  .process-step p {
    color: #64748b;
    line-height: 1.6;
  }

  /* Social Proof */
  .social-proof {
    padding: 80px 0;
    background: #f8fafc;
  }

  .social-proof h2 {
    text-align: center;
    font-size: 2.5rem;
    font-weight: 900;
    margin-bottom: 3rem;
    color: #1e293b;
  }

  .testimonial-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  .testimonial {
    background: white;
    padding: 2rem;
    border-radius: 16px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    position: relative;
  }

  .quote-icon {
    font-size: 3rem;
    color: #667eea;
    opacity: 0.2;
    line-height: 1;
    margin-bottom: 1rem;
  }

  .testimonial p {
    color: #334155;
    line-height: 1.7;
    margin-bottom: 1.5rem;
  }

  .testimonial-author strong {
    display: block;
    font-weight: 700;
    color: #1e293b;
    margin-bottom: 0.25rem;
  }

  .testimonial-author span {
    color: #64748b;
    font-size: 0.875rem;
  }

  /* Results Section Styles */
  .results-section {
    padding-top: 2rem;
  }

  .opportunity-header {
    text-align: center;
    margin-bottom: 3rem;
    padding-bottom: 2rem;
    border-bottom: 2px solid #f1f5f9;
  }

  .opportunity-badge {
    display: inline-block;
    padding: 0.75rem 1.5rem;
    border-radius: 50px;
    font-weight: 700;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 1.5rem;
  }

  .opportunity-badge.hot {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
    animation: pulse-badge 2s ease-in-out infinite;
  }

  .opportunity-badge.warm {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
  }

  .opportunity-badge.qualified {
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    color: white;
  }

  .opportunity-badge.low {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
  }

  @keyframes pulse-badge {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  .opportunity-header h2 {
    font-size: 2.5rem;
    font-weight: 900;
    margin-bottom: 1.5rem;
    color: #1e293b;
  }

  .opportunity-value {
    margin-bottom: 1rem;
  }

  .value-main {
    font-size: 4rem;
    font-weight: 900;
    background: linear-gradient(135deg, #667eea, #764ba2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1;
    margin-bottom: 0.5rem;
  }

  @media (max-width: 768px) {
    .value-main {
      font-size: 3rem;
    }
  }

  .value-label {
    font-size: 1.125rem;
    color: #64748b;
    font-weight: 600;
  }

  .opportunity-subtitle {
    color: #64748b;
    font-size: 1rem;
  }

  /* Metrics Grid */
  .metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 3rem;
  }

  .metric-card {
    background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
    border: 2px solid #e2e8f0;
    border-radius: 16px;
    padding: 2rem 1.5rem;
    text-align: center;
    transition: all 0.3s ease;
  }

  .metric-card:hover {
    border-color: #667eea;
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.15);
  }

  .metric-icon {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  .metric-value {
    font-size: 2.5rem;
    font-weight: 900;
    color: #1e293b;
    margin-bottom: 0.5rem;
    line-height: 1;
  }

  .metric-label {
    font-size: 0.875rem;
    font-weight: 700;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.25rem;
  }

  .metric-sublabel {
    font-size: 0.875rem;
    color: #94a3b8;
  }

  /* Opportunity Breakdown */
  .opportunity-breakdown {
    margin-bottom: 3rem;
  }

  .opportunity-breakdown h3 {
    font-size: 1.75rem;
    font-weight: 800;
    margin-bottom: 1.5rem;
    color: #1e293b;
  }

  .breakdown-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  .breakdown-card {
    background: white;
    border-radius: 16px;
    padding: 2rem;
    border: 2px solid #e2e8f0;
    transition: all 0.3s ease;
  }

  .breakdown-card:hover {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
  }

  .breakdown-card.quick-win {
    border-color: #10b981;
    background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%);
  }

  .breakdown-card.strategic {
    border-color: #667eea;
    background: linear-gradient(135deg, #f5f7ff 0%, #ffffff 100%);
  }

  .breakdown-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .breakdown-icon {
    font-size: 2rem;
  }

  .breakdown-title {
    font-size: 1.125rem;
    font-weight: 700;
    color: #1e293b;
    flex: 1;
  }

  .breakdown-badge {
    background: rgba(102, 126, 234, 0.1);
    color: #667eea;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 700;
  }

  .breakdown-value {
    font-size: 2.5rem;
    font-weight: 900;
    color: #1e293b;
    margin-bottom: 0.75rem;
  }

  .breakdown-description {
    color: #64748b;
    margin-bottom: 1.5rem;
    line-height: 1.6;
  }

  .breakdown-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .breakdown-list li {
    padding: 0.5rem 0;
    padding-left: 1.5rem;
    position: relative;
    color: #475569;
  }

  .breakdown-list li::before {
    content: '✓';
    position: absolute;
    left: 0;
    color: #10b981;
    font-weight: 700;
  }

  /* Benchmarks Section */
  .benchmarks-section {
    background: #f8fafc;
    border-radius: 16px;
    padding: 2rem;
    margin-bottom: 3rem;
  }

  .benchmarks-section h3 {
    font-size: 1.75rem;
    font-weight: 800;
    margin-bottom: 2rem;
    color: #1e293b;
  }

  .benchmark-bars {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .benchmark-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .benchmark-label {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .benchmark-label span {
    color: #64748b;
    font-size: 0.875rem;
    font-weight: 600;
  }

  .benchmark-label strong {
    color: #1e293b;
    font-size: 1rem;
  }

  .benchmark-bar {
    width: 100%;
    height: 12px;
    background: #e2e8f0;
    border-radius: 6px;
    overflow: hidden;
  }

  .bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #667eea, #764ba2);
    border-radius: 6px;
    transition: width 1s ease-out;
  }

  .bar-fill.average {
    background: linear-gradient(90deg, #f59e0b, #d97706);
  }

  .bar-fill.top {
    background: linear-gradient(90deg, #10b981, #059669);
  }

  .benchmark-note {
    color: #64748b;
    font-size: 0.875rem;
    padding: 1rem;
    background: white;
    border-radius: 8px;
  }

  .benchmark-note i {
    color: #667eea;
    margin-right: 0.5rem;
  }

  .benchmark-note strong {
    color: #ef4444;
  }

  /* Action Plan */
  .action-plan-section {
    margin-bottom: 3rem;
  }

  .action-plan-section h3 {
    font-size: 1.75rem;
    font-weight: 800;
    margin-bottom: 1.5rem;
    color: #1e293b;
  }

  .action-plan-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .action-plan-item {
    display: flex;
    gap: 1.5rem;
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    padding: 1.5rem;
    transition: all 0.3s ease;
  }

  .action-plan-item:hover {
    border-color: #667eea;
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
  }

  .action-plan-item.priority-critical {
    border-left: 4px solid #ef4444;
  }

  .action-plan-item.priority-high {
    border-left: 4px solid #f59e0b;
  }

  .action-plan-item.priority-medium {
    border-left: 4px solid #3b82f6;
  }

  .action-number {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 900;
    flex-shrink: 0;
  }

  .action-content {
    flex: 1;
  }

  .action-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 0.75rem;
  }

  .action-header h4 {
    font-size: 1.125rem;
    font-weight: 700;
    color: #1e293b;
    flex: 1;
  }

  .action-badge {
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
  }

  .action-badge.critical {
    background: #fef2f2;
    color: #ef4444;
  }

  .action-badge.high {
    background: #fffbeb;
    color: #f59e0b;
  }

  .action-badge.medium {
    background: #eff6ff;
    color: #3b82f6;
  }

  .action-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    font-size: 0.875rem;
    color: #64748b;
  }

  .action-meta span {
    display: flex;
    align-items: center;
    gap: 0.375rem;
  }

  .action-meta i {
    color: #94a3b8;
  }

  /* CTA Sections */
  .cta-section {
    border-radius: 20px;
    padding: 3rem;
    margin-bottom: 3rem;
    text-align: center;
  }

  .cta-section.cta-emergency {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    color: white;
    box-shadow: 0 12px 48px rgba(239, 68, 68, 0.4);
    animation: pulse-cta 3s ease-in-out infinite;
  }

  @keyframes pulse-cta {
    0%, 100% { transform: scale(1); box-shadow: 0 12px 48px rgba(239, 68, 68, 0.4); }
    50% { transform: scale(1.02); box-shadow: 0 16px 64px rgba(239, 68, 68, 0.5); }
  }

  .cta-section.cta-value {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    box-shadow: 0 12px 48px rgba(102, 126, 234, 0.3);
  }

  .cta-section.cta-standard {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    color: white;
  }

  .cta-section.cta-nurture {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    color: #1e293b;
    border: 2px solid #cbd5e1;
  }

  .cta-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .cta-section h3 {
    font-size: 2rem;
    font-weight: 900;
    margin-bottom: 1rem;
    color: inherit;
  }

  .cta-section p {
    font-size: 1.125rem;
    margin-bottom: 2rem;
    opacity: 0.95;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .cta-benefits {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .cta-benefit {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    background: rgba(255, 255, 255, 0.15);
    padding: 1rem;
    border-radius: 8px;
    font-weight: 600;
  }

  .cta-benefit i {
    font-size: 1.25rem;
  }

  .cta-features {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .cta-feature {
    display: flex;
    align-items: center;
    gap: 1rem;
    background: rgba(255, 255, 255, 0.15);
    padding: 1.5rem;
    border-radius: 12px;
  }

  .cta-feature i {
    font-size: 2rem;
  }

  .cta-feature div {
    text-align: left;
  }

  .cta-feature strong {
    display: block;
    font-size: 1.125rem;
    margin-bottom: 0.25rem;
  }

  .cta-feature span {
    font-size: 0.875rem;
    opacity: 0.9;
  }

  .cta-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .btn-cta-primary {
    background: white;
    color: #1e293b;
    padding: 1.25rem 2.5rem;
    border-radius: 12px;
    font-weight: 700;
    font-size: 1.125rem;
    text-decoration: none;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
  }

  .btn-cta-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  }

  .cta-main {
    font-size: 1.125rem;
  }

  .cta-sub {
    font-size: 0.875rem;
    color: #64748b;
  }

  .btn-cta-secondary {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 1rem 2rem;
    border-radius: 12px;
    font-weight: 600;
    text-decoration: none;
    border: 2px solid rgba(255, 255, 255, 0.3);
    transition: all 0.3s ease;
  }

  .btn-cta-secondary:hover {
    background: rgba(255, 255, 255, 0.3);
  }

  .btn-cta-phone {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 1rem 2rem;
    border-radius: 12px;
    font-weight: 700;
    text-decoration: none;
    border: 2px solid rgba(255, 255, 255, 0.3);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .btn-cta-phone:hover {
    background: rgba(255, 255, 255, 0.3);
  }

  .cta-urgency {
    margin-top: 1rem;
    font-size: 0.875rem;
    font-weight: 600;
  }

  .cta-note {
    margin-top: 1rem;
    font-size: 0.875rem;
    opacity: 0.9;
  }

  /* Result Actions */
  .result-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
    padding-top: 2rem;
    border-top: 2px solid #f1f5f9;
  }

  @media (max-width: 768px) {
    .opportunity-header h2 {
      font-size: 2rem;
    }

    .metrics-grid {
      grid-template-columns: 1fr;
    }

    .breakdown-grid {
      grid-template-columns: 1fr;
    }

    .cta-section {
      padding: 2rem 1.5rem;
    }

    .cta-buttons {
      flex-direction: column;
      width: 100%;
    }

    .btn-cta-primary,
    .btn-cta-secondary,
    .btn-cta-phone {
      width: 100%;
      justify-content: center;
    }
  }
</style>

<script define:vars={{ apiUrl }}>
  /**
   * SEO Opportunity Calculator - Frontend Logic
   *
   * KEY GOALS:
   * 1. Fast, smooth UX (no janky loading states)
   * 2. Track EVERYTHING (we need conversion data)
   * 3. Smart CTAs based on opportunity size
   * 4. Qualify leads in real-time
   */

  // Analytics tracking
  function trackEvent(eventName, params = {}) {
    if (typeof window !== 'undefined' && window.gtag) {
      window.gtag('event', eventName, params);
    }
    if (typeof window !== 'undefined' && window.fbq) {
      if (eventName === 'calculator_started') {
        window.fbq('track', 'InitiateCheckout', { content_name: 'SEO Opportunity Calculator' });
      } else if (eventName === 'high_value_lead') {
        window.fbq('track', 'Lead', { value: params.opportunityValue || 1000, currency: 'AUD' });
      }
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('opportunityForm');
    const loadingState = document.getElementById('loadingState');
    const resultsSection = document.getElementById('resultsSection');
    const errorState = document.getElementById('errorState');
    const calculateButton = document.getElementById('calculateButton');

    let analysisStartTime;

    // Form submission
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      analysisStartTime = Date.now();

      const formData = {
        website: document.getElementById('website').value.trim(),
        industry: document.getElementById('industry').value,
        serviceArea: document.getElementById('serviceArea').value,
        avgDealValue: document.getElementById('avgDealValue').value,
        primaryGoal: document.getElementById('primaryGoal').value,
      };

      // Track tool usage (Discord notification)
      if (window.trackToolUsage) {
        window.trackToolUsage('SEO Opportunity Calculator', { website: formData.website, industry: formData.industry });
      }

      // Track start
      trackEvent('calculator_started', {
        industry: formData.industry,
        service_area: formData.serviceArea,
        avg_deal_value: formData.avgDealValue,
      });

      // Show loading state
      form.style.display = 'none';
      loadingState.style.display = 'block';
      resultsSection.style.display = 'none';
      errorState.style.display = 'none';

      // Update step indicator
      updateStepIndicator(2);

      // Animate loading steps
      animateLoadingSteps();

      try {
        const response = await fetch(`${apiUrl}/api/seo-opportunity`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(formData),
        });

        const data = await response.json();

        if (!response.ok || !data.success) {
          throw new Error(data.error || 'Failed to calculate opportunity');
        }

        // Track completion
        const analysisTime = Date.now() - analysisStartTime;
        trackEvent('calculator_completed', {
          industry: formData.industry,
          opportunity_value: data.analysis.opportunity.totalAnnualValue,
          analysis_time_seconds: Math.round(analysisTime / 1000),
          lead_tier: data.qualification.tier,
        });

        // Track high-value leads separately
        if (data.qualification.tier === 'hot' || data.qualification.tier === 'warm') {
          trackEvent('high_value_lead', {
            opportunityValue: data.analysis.opportunity.totalAnnualValue,
            tier: data.qualification.tier,
            industry: formData.industry,
          });
        }

        // Display results
        displayResults(data, formData);

      } catch (error) {
        console.error('Calculator error:', error);
        showError(error.message);

        trackEvent('calculator_error', {
          error_message: error.message,
          industry: formData.industry,
        });
      }
    });

    // Animate loading steps
    function animateLoadingSteps() {
      const steps = document.querySelectorAll('.analysis-step');
      let currentStep = 0;

      const interval = setInterval(() => {
        if (currentStep < steps.length) {
          // Mark previous as completed
          if (currentStep > 0) {
            steps[currentStep - 1].classList.remove('active');
            steps[currentStep - 1].classList.add('completed');
            steps[currentStep - 1].querySelector('i').className = 'fas fa-check-circle';
          }

          // Activate current
          steps[currentStep].classList.add('active');
          currentStep++;
        } else {
          clearInterval(interval);
        }
      }, 3000); // 3 seconds per step = ~15 seconds total
    }

    // Update step indicator
    function updateStepIndicator(stepNumber) {
      const steps = document.querySelectorAll('.step');
      steps.forEach((step, index) => {
        if (index < stepNumber - 1) {
          step.classList.add('completed');
          step.classList.remove('active');
        } else if (index === stepNumber - 1) {
          step.classList.add('active');
        } else {
          step.classList.remove('active', 'completed');
        }
      });
    }

    // Display results
    function displayResults(data, formData) {
      loadingState.style.display = 'none';
      resultsSection.style.display = 'block';
      updateStepIndicator(3);

      const analysis = data.analysis;
      const qualification = data.qualification;

      resultsSection.innerHTML = `
        <!-- Overall Opportunity -->
        <div class="opportunity-header">
          <div class="opportunity-badge ${qualification.tier}">
            ${qualification.tier === 'hot' ? '🔥 HIGH OPPORTUNITY' :
              qualification.tier === 'warm' ? '💎 STRONG OPPORTUNITY' :
              qualification.tier === 'qualified' ? '✓ OPPORTUNITY FOUND' :
              '💡 POTENTIAL OPPORTUNITY'}
          </div>
          <h2>Your SEO Opportunity</h2>
          <div class="opportunity-value">
            <div class="value-main">$${analysis.opportunity.totalAnnualValue.toLocaleString()}</div>
            <div class="value-label">Estimated Annual Opportunity</div>
          </div>
          <p class="opportunity-subtitle">
            Based on ${formData.industry} industry benchmarks in ${formData.serviceArea.replace('-', ' ')}
          </p>
        </div>

        <!-- Key Metrics -->
        <div class="metrics-grid">
          <div class="metric-card">
            <div class="metric-icon">📊</div>
            <div class="metric-value">${analysis.currentState.visibility}%</div>
            <div class="metric-label">Current Visibility</div>
            <div class="metric-sublabel">vs. ${analysis.benchmarks.yourPosition}</div>
          </div>
          <div class="metric-card">
            <div class="metric-icon">🎯</div>
            <div class="metric-value">${analysis.gaps.keywords}</div>
            <div class="metric-label">Missing Keywords</div>
            <div class="metric-sublabel">${analysis.gaps.quickWins} quick wins</div>
          </div>
          <div class="metric-card">
            <div class="metric-icon">📈</div>
            <div class="metric-value">$${analysis.opportunity.monthlyValue.toLocaleString()}</div>
            <div class="metric-label">Monthly Potential</div>
            <div class="metric-sublabel">${analysis.opportunity.newLeadsPerMonth} new leads/mo</div>
          </div>
          <div class="metric-card">
            <div class="metric-icon">⏱️</div>
            <div class="metric-value">${analysis.opportunity.timeToROI}</div>
            <div class="metric-label">Time to ROI</div>
            <div class="metric-sublabel">Quick wins first</div>
          </div>
        </div>

        <!-- Breakdown -->
        <div class="opportunity-breakdown">
          <h3>Opportunity Breakdown</h3>
          <div class="breakdown-grid">
            <div class="breakdown-card quick-win">
              <div class="breakdown-header">
                <div class="breakdown-icon">⚡</div>
                <div class="breakdown-title">Quick Wins</div>
                <div class="breakdown-badge">90 Days</div>
              </div>
              <div class="breakdown-value">$${analysis.opportunity.quickWinValue.toLocaleString()}</div>
              <div class="breakdown-description">
                ${analysis.gaps.quickWins} low-competition keywords you can rank for quickly
              </div>
              <ul class="breakdown-list">
                ${analysis.gaps.quickWins > 0 ? `
                  <li>Immediate visibility improvements</li>
                  <li>Fast traffic growth</li>
                  <li>Low implementation cost</li>
                ` : '<li>Optimize existing content first</li>'}
              </ul>
            </div>

            <div class="breakdown-card strategic">
              <div class="breakdown-header">
                <div class="breakdown-icon">🎯</div>
                <div class="breakdown-title">Strategic Growth</div>
                <div class="breakdown-badge">6-12 Months</div>
              </div>
              <div class="breakdown-value">$${analysis.opportunity.strategicValue.toLocaleString()}</div>
              <div class="breakdown-description">
                ${analysis.gaps.strategicOpportunities} high-value keywords for long-term dominance
              </div>
              <ul class="breakdown-list">
                <li>Sustainable traffic growth</li>
                <li>Industry authority building</li>
                <li>Competitive moat creation</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Industry Benchmarks -->
        <div class="benchmarks-section">
          <h3>How You Compare</h3>
          <div class="benchmark-bars">
            <div class="benchmark-item">
              <div class="benchmark-label">
                <span>Your Current Traffic</span>
                <strong>${analysis.currentState.estimatedTraffic.toLocaleString()}/mo</strong>
              </div>
              <div class="benchmark-bar">
                <div class="bar-fill" style="width: ${(analysis.currentState.estimatedTraffic / analysis.benchmarks.topPerformers * 100)}%"></div>
              </div>
            </div>
            <div class="benchmark-item">
              <div class="benchmark-label">
                <span>Industry Average</span>
                <strong>${analysis.benchmarks.industryAverage.toLocaleString()}/mo</strong>
              </div>
              <div class="benchmark-bar">
                <div class="bar-fill average" style="width: ${(analysis.benchmarks.industryAverage / analysis.benchmarks.topPerformers * 100)}%"></div>
              </div>
            </div>
            <div class="benchmark-item">
              <div class="benchmark-label">
                <span>Top Performers</span>
                <strong>${analysis.benchmarks.topPerformers.toLocaleString()}/mo</strong>
              </div>
              <div class="benchmark-bar">
                <div class="bar-fill top" style="width: 100%"></div>
              </div>
            </div>
          </div>
          <p class="benchmark-note">
            <i class="fas fa-info-circle"></i>
            Top performers in your industry get <strong>${analysis.gaps.competitorAdvantage} more traffic</strong> than you
          </p>
        </div>

        <!-- Action Plan -->
        <div class="action-plan-section">
          <h3>Your Priority Action Plan</h3>
          <div class="action-plan-list">
            ${analysis.actionPlan.map((item, index) => `
              <div class="action-plan-item priority-${item.priority}">
                <div class="action-number">${index + 1}</div>
                <div class="action-content">
                  <div class="action-header">
                    <h4>${item.action}</h4>
                    <span class="action-badge ${item.priority}">${item.priority.toUpperCase()}</span>
                  </div>
                  <div class="action-meta">
                    <span><i class="fas fa-tag"></i> ${item.category}</span>
                    <span><i class="fas fa-clock"></i> ${item.timeframe}</span>
                    <span><i class="fas fa-chart-line"></i> ${item.impact} Impact</span>
                    <span><i class="fas fa-dollar-sign"></i> +$${item.estimatedValue.toLocaleString()}/year</span>
                  </div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>

        <!-- Dynamic CTA based on qualification -->
        ${generateCTA(qualification, analysis, formData)}

        <!-- Export Options -->
        <div class="result-actions">
          <button class="btn-secondary" onclick="window.print()">
            <i class="fas fa-print"></i> Print Report
          </button>
          <button class="btn-secondary" onclick="shareResults()">
            <i class="fas fa-share-alt"></i> Share
          </button>
          <button class="btn-secondary" onclick="location.reload()">
            <i class="fas fa-redo"></i> New Analysis
          </button>
        </div>
      `;
    }

    // Generate CTA based on lead qualification
    window.generateCTA = function(qualification, analysis, formData) {
      const opportunityValue = analysis.opportunity.totalAnnualValue;

      if (qualification.tier === 'hot') {
        // High-value lead: Emergency/urgent CTA
        return `
          <div class="cta-section cta-emergency">
            <div class="cta-icon">🚨</div>
            <h3>You're Leaving $${Math.round(opportunityValue / 12).toLocaleString()}/Month on the Table</h3>
            <p>With <strong>$${opportunityValue.toLocaleString()}/year</strong> in opportunity, every day you wait costs money. Our SEO sprint service can capture your quick wins in just 90 days.</p>
            <div class="cta-benefits">
              <div class="cta-benefit">
                <i class="fas fa-check-circle"></i>
                <span>90-day quick win guarantee</span>
              </div>
              <div class="cta-benefit">
                <i class="fas fa-check-circle"></i>
                <span>Priority onboarding this week</span>
              </div>
              <div class="cta-benefit">
                <i class="fas fa-check-circle"></i>
                <span>ROI tracking from day 1</span>
              </div>
            </div>
            <div class="cta-buttons">
              <a href="/contact?source=calculator&tier=hot&value=${opportunityValue}" class="btn-cta-primary" onclick="trackEvent('cta_clicked', {tier: 'hot', opportunity: ${opportunityValue}, cta_type: 'contact'})">
                <span class="cta-main">Book Strategy Call Now</span>
                <span class="cta-sub">Limited slots available this week</span>
              </a>
              <a href="tel:+61487286451" class="btn-cta-phone" onclick="trackEvent('cta_clicked', {tier: 'hot', opportunity: ${opportunityValue}, cta_type: 'phone'})">
                <i class="fas fa-phone"></i>
                <span>Call Avi: 0487 286 451</span>
              </a>
            </div>
            <p class="cta-urgency">⏰ Next available slot: This Wednesday at 2pm</p>
          </div>
        `;
      } else if (qualification.tier === 'warm') {
        // Medium-value lead: Value-focused CTA
        return `
          <div class="cta-section cta-value">
            <div class="cta-icon">💎</div>
            <h3>Ready to Capture $${opportunityValue.toLocaleString()} in Revenue?</h3>
            <p>You have <strong>${analysis.gaps.quickWins} quick-win opportunities</strong> we can tackle in the next 90 days. Let's build a custom roadmap for your business.</p>
            <div class="cta-features">
              <div class="cta-feature">
                <i class="fas fa-chart-line"></i>
                <div>
                  <strong>Custom Strategy</strong>
                  <span>Tailored to ${formData.industry}</span>
                </div>
              </div>
              <div class="cta-feature">
                <i class="fas fa-bullseye"></i>
                <div>
                  <strong>Quick Wins First</strong>
                  <span>ROI in 90 days</span>
                </div>
              </div>
              <div class="cta-feature">
                <i class="fas fa-handshake"></i>
                <div>
                  <strong>No Lock-ins</strong>
                  <span>Month-to-month</span>
                </div>
              </div>
            </div>
            <div class="cta-buttons">
              <a href="/contact?source=calculator&tier=warm&value=${opportunityValue}" class="btn-cta-primary" onclick="trackEvent('cta_clicked', {tier: 'warm', opportunity: ${opportunityValue}, cta_type: 'contact'})">
                Get Your Custom SEO Roadmap
              </a>
              <a href="tel:+61487286451" class="btn-cta-secondary" onclick="trackEvent('cta_clicked', {tier: 'warm', opportunity: ${opportunityValue}, cta_type: 'phone'})">
                <i class="fas fa-phone"></i> 0487 286 451
              </a>
            </div>
          </div>
        `;
      } else if (qualification.tier === 'qualified') {
        // Lower-value but qualified: Standard CTA
        return `
          <div class="cta-section cta-standard">
            <div class="cta-icon">✓</div>
            <h3>Let's Build Your SEO Foundation</h3>
            <p>With <strong>$${opportunityValue.toLocaleString()}/year</strong> in potential, investing in SEO makes sense. Start with a free consultation to map out your path forward.</p>
            <div class="cta-buttons">
              <a href="/contact?source=calculator&tier=qualified&value=${opportunityValue}" class="btn-cta-primary" onclick="trackEvent('cta_clicked', {tier: 'qualified', opportunity: ${opportunityValue}, cta_type: 'contact'})">
                Book Free Consultation
              </a>
            </div>
            <p class="cta-note">No pressure, no commitment - just expert advice</p>
          </div>
        `;
      } else {
        // Low-value: Nurture/education CTA
        return `
          <div class="cta-section cta-nurture">
            <div class="cta-icon">💡</div>
            <h3>Want to Learn More?</h3>
            <p>We've put together a free guide on SEO for ${formData.industry} businesses that shows you exactly how to implement these opportunities.</p>
            <div class="cta-buttons">
              <a href="/guides/seo-${formData.industry}" class="btn-cta-secondary" onclick="trackEvent('cta_clicked', {tier: 'low', opportunity: ${opportunityValue}, cta_type: 'guide'})">
                Get Free SEO Guide
              </a>
              <a href="/blog" class="btn-cta-secondary" onclick="trackEvent('cta_clicked', {tier: 'low', opportunity: ${opportunityValue}, cta_type: 'blog'})">
                Read SEO Tips
              </a>
            </div>
          </div>
        `;
      }
    };

    // Show error
    function showError(message) {
      loadingState.style.display = 'none';
      errorState.style.display = 'block';
      resultsSection.style.display = 'none';
      document.getElementById('errorMessage').textContent = message;
    }

    // Try again button
    document.getElementById('tryAgainButton')?.addEventListener('click', () => {
      errorState.style.display = 'none';
      form.style.display = 'block';
      updateStepIndicator(1);
    });

    // Share results
    window.shareResults = async function() {
      const url = window.location.href;
      if (navigator.share) {
        try {
          await navigator.share({
            title: 'My SEO Opportunity Report',
            text: 'I just discovered my website\'s SEO opportunity',
            url: url
          });
        } catch (err) {
          console.log('Share failed:', err);
        }
      } else {
        navigator.clipboard.writeText(url);
        alert('Link copied to clipboard!');
      }
    };
  });
</script>
