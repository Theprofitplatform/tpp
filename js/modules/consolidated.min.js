/**
 * Consolidated.min Module
 * Converted to ES6 module with enhanced functionality
 */

import utils from './shared-utils.js';
const { $, $$, delegate, debounce, throttle, fetchWithRetry, track, ready } = utils;

class Consolidated.min {
    constructor() {
        this.init();
    }

    init() {
        /* Consolidated & Minified JavaScript - Performance Optimized */
((){'use strict';const loadTime=window.performance.timing.domContentLoadedEventEnd-window.performance.timing.navigationStart;console.log(`Page loaded in ${loadTime}ms`);

/* Navigation */
const nav={toggle:document.querySelector('.nav-toggle'),menu:document.querySelector('.nav-menu'),init(){if(this.toggle&&this.menu){this.toggle.addEventListener('click',()=>this.toggleMenu());document.addEventListener('click',(e)=>{if(!e.target.closest('.navigation')){this.closeMenu()}});window.addEventListener('scroll',()=>this.handleScroll())}},toggleMenu(){this.menu.classList.toggle('active');this.toggle.setAttribute('aria-expanded',this.menu.classList.contains('active'))},closeMenu(){this.menu.classList.remove('active');this.toggle.setAttribute('aria-expanded','false')},handleScroll(){const nav=document.querySelector('.navigation');if(window.scrollY>100){nav.classList.add('scrolled')}else{nav.classList.remove('scrolled')}}};

/* Smooth Scrolling */
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener('click',(e){const target=document.querySelector(this.getAttribute('href'));if(target){e.preventDefault();target.scrollIntoView({behavior:'smooth',block:'start'})}})});

/* Lazy Loading */
const lazyLoad={images:document.querySelectorAll('img[data-src]'),init(){if('IntersectionObserver' in window){const imageObserver=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){const img=entry.target;img.src=img.dataset.src;img.removeAttribute('data-src');img.classList.add('lazyloaded');imageObserver.unobserve(img)}})},{rootMargin:'50px 0px'});this.images.forEach(img=>imageObserver.observe(img))}else{this.loadAllImages()}},loadAllImages(){this.images.forEach(img=>{img.src=img.dataset.src;img.removeAttribute('data-src');img.classList.add('lazyloaded')})}};

/* Form Validation */
const forms={init(){document.querySelectorAll('form').forEach(form=>{form.addEventListener('submit',(e)=>this.handleSubmit(e))})},handleSubmit(e){const form=e.target;const requiredFields=form.querySelectorAll('[required]');let isValid=true;requiredFields.forEach(field=>{if(!field.value.trim()){isValid=false;this.showError(field,'This field is required')}else if(field.type==='email'&&!this.validateEmail(field.value)){isValid=false;this.showError(field,'Please enter a valid email')}else{this.clearError(field)}});if(!isValid){e.preventDefault()}},validateEmail(email){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)},showError(field,message){const error=field.parentElement.querySelector('.error-message')||document.createElement('span');error.className='error-message';error.textContent=message;field.classList.add('error');if(!field.parentElement.querySelector('.error-message')){field.parentElement.appendChild(error)}},clearError(field){field.classList.remove('error');const error=field.parentElement.querySelector('.error-message');if(error)error.remove()}};

/* Performance Monitor */
const perfMonitor={init(){if(window.performance&&window.performance.timing){this.trackMetrics();this.reportWebVitals()}},trackMetrics(){const timing=window.performance.timing;const metrics={domContentLoaded:timing.domContentLoadedEventEnd-timing.navigationStart,loadComplete:timing.loadEventEnd-timing.navigationStart,firstByte:timing.responseStart-timing.navigationStart,domInteractive:timing.domInteractive-timing.navigationStart};console.table(metrics);if(metrics.loadComplete>3000){console.warn('Page load time exceeds 3 seconds')}},reportWebVitals(){if('PerformanceObserver' in window){try{const po=new PerformanceObserver(list=>{for(const entry of list.getEntries()){console.log(`${entry.name}: ${entry.value}ms`)}});po.observe({entryTypes:['paint','largest-contentful-paint']})}catch(e){}}}};

/* Animation on Scroll */
const scrollAnimations={elements:document.querySelectorAll('.animate-fadeIn,.animate-slideInLeft,.animate-slideInRight'),init(){if('IntersectionObserver' in window){const observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add('animated');observer.unobserve(entry.target)}})},{threshold:0.1});this.elements.forEach(el=>observer.observe(el))}else{this.elements.forEach(el=>el.classList.add('animated'))}

/* Contact Form Handler */
const contactForm={form:document.querySelector('#contact-form'),init(){if(this.form){this.form.addEventListener('submit',(e)=>this.handleSubmit(e))}},async handleSubmit(e){e.preventDefault();const formData=new FormData(this.form);const button=this.form.querySelector('button[type="submit"]');button.disabled=true;button.textContent='Sending...';try{const response=await fetch('/api/contact',{method:'POST',body:formData});if(response.ok){this.showSuccess();this.form.reset()}else{this.showError()}}catch(error){this.showError()}finally{button.disabled=false;button.textContent='Send Message'}},showSuccess(){const msg=document.createElement('div');msg.className='alert alert-success';msg.textContent='Message sent successfully!';this.form.appendChild(msg);setTimeout(()=>msg.remove(),5000)},showError(){const msg=document.createElement('div');msg.className='alert alert-error';msg.textContent='Failed to send message. Please try again.';this.form.appendChild(msg);setTimeout(()=>msg.remove(),5000)}};

/* Accessibility Enhancements */
const a11y={init(){this.setupSkipLinks();this.manageFocus();this.announcePageChanges()},setupSkipLinks(){const skipLink=document.querySelector('a[href="#main-content"]');if(skipLink){skipLink.addEventListener('click',(e)=>{e.preventDefault();const target=document.querySelector('#main-content');if(target){target.tabIndex=-1;target.focus();target.removeAttribute('tabIndex')}})}},manageFocus(){document.addEventListener('keydown',(e)=>{if(e.key==='Tab'){document.body.classList.add('keyboard-nav')}});document.addEventListener('mousedown',()=>{document.body.classList.remove('keyboard-nav')})},announcePageChanges(){const announcer=document.createElement('div');announcer.setAttribute('aria-live','polite');announcer.setAttribute('aria-atomic','true');announcer.className='sr-only';document.body.appendChild(announcer);window.announceChange=(message)=>{announcer.textContent=message;setTimeout(()=>announcer.textContent='',1000)}}};

/* Initialize Everything */
document.addEventListener('DOMContentLoaded',()=>{nav.init();lazyLoad.init();forms.init();perfMonitor.init();scrollAnimations.init();contactForm.init();a11y.init();document.body.classList.add('js-enabled')});

/* Service Worker Registration */
if('serviceWorker' in navigator){window.addEventListener('load',()=>{navigator.serviceWorker.register('/sw.js')try { await reg=>console.log('Service Worker registered') } catch err=>console.log('Service Worker registration failed')})}})();
    }
}

export default new Consolidated.min();

// Performance tracking
track('module_loaded', { module: 'consolidated.min' });